<!---
Copryight 2017 floragunn GmbH
-->

<h1 id="audit-log-field-reference">Audit Log Field Reference</h1>

<h2 id="common-attributes">Common Attributes</h2>

<p>The following attributes are logged for all event categores, independent of the layer.</p>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>audit_format_version</td>
      <td>Audit log message format version, current: 3</td>
    </tr>
    <tr>
      <td>audit_utc_timestamp</td>
      <td>UTC timestamp when the event was generated</td>
    </tr>
    <tr>
      <td>audit_category</td>
      <td>Audit log category, one of FAILED_LOGIN, MISSING_PRIVILEGES, BAD_HEADERS, SSL_EXCEPTION, SG_INDEX_ATTEMPT, AUTHENTICATED or GRANTED_PRIVILEGES.</td>
    </tr>
    <tr>
      <td>audit_node_id</td>
      <td>The ID of the node where the event was generated.</td>
    </tr>
    <tr>
      <td>audit_node_name</td>
      <td>The name of the node where the event was generated.</td>
    </tr>
    <tr>
      <td>audit_node_host_address</td>
      <td>The host address of the node where the event was generated.</td>
    </tr>
    <tr>
      <td>audit_node_host_name</td>
      <td>The host address of the node where the event was generated.</td>
    </tr>
    <tr>
      <td>audit_request_layer</td>
      <td>The layer on which the event has been generated. One if <code class="highlighter-rouge">TRANSPORT</code> or <code class="highlighter-rouge">REST</code>.</td>
    </tr>
    <tr>
      <td>audit_request_origin</td>
      <td>The layer from which the event originated. One if <code class="highlighter-rouge">TRANSPORT</code> or <code class="highlighter-rouge">REST</code>.</td>
    </tr>
    <tr>
      <td>audit_request_effective_user_is_admin</td>
      <td>true if the request was made wit an TLS admin certificate, false otherwise.</td>
    </tr>
  </tbody>
</table>

<h2 id="rest-failed_login-attributes">REST FAILED_LOGIN attributes</h2>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>audit_request_effective_user</td>
      <td>The username tthat failed authentication.</td>
    </tr>
    <tr>
      <td>audit_rest_request_path</td>
      <td>The REST endpoint URI</td>
    </tr>
    <tr>
      <td>audit_rest_request_params</td>
      <td>The HTTP request parameters, if any. Optional.</td>
    </tr>
    <tr>
      <td>audit_rest_request_headers</td>
      <td>The HTTP headers, if any. Optional.</td>
    </tr>
    <tr>
      <td>audit_request_initiating_user</td>
      <td>The user that initiated the request. Only logged if it differs from the effective user, for example when using impersonation. Optional.</td>
    </tr>
    <tr>
      <td>audit_request_body</td>
      <td>The HTTP body, if any and if request body logging is enabled. Optional.</td>
    </tr>
  </tbody>
</table>

<h2 id="rest-authenticated-attributes">REST AUTHENTICATED attributes</h2>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>audit_request_effective_user</td>
      <td>The username / principal that failed authentication.</td>
    </tr>
    <tr>
      <td>audit_request_initiating_user</td>
      <td>The user that initiated the request. Only logged if it differs from the effective user, for example when using impersonation. Optional.</td>
    </tr>
    <tr>
      <td>audit_rest_request_path</td>
      <td>The REST endpoint URI</td>
    </tr>
    <tr>
      <td>audit_rest_request_params</td>
      <td>The HTTP request parameters, if any. Optional.</td>
    </tr>
    <tr>
      <td>audit_rest_request_headers</td>
      <td>The HTTP headers, if any. Optional.</td>
    </tr>
    <tr>
      <td>audit_request_body</td>
      <td>The HTTP body, if any and if request body logging is enabled. Optional.</td>
    </tr>
  </tbody>
</table>

<h2 id="rest-ssl_exception-attributes">REST SSL_EXCEPTION attributes</h2>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>audit_request_exception_stacktrace</td>
      <td>The stacktrace of the SSL Exception</td>
    </tr>
  </tbody>
</table>

<h2 id="rest-bad_headers-attributes">REST BAD_HEADERS attributes</h2>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>audit_rest_request_path</td>
      <td>The REST endpoint URI</td>
    </tr>
    <tr>
      <td>audit_rest_request_params</td>
      <td>The HTTP request parameters, if any. Optional.</td>
    </tr>
    <tr>
      <td>audit_rest_request_headers</td>
      <td>The HTTP headers, if any. Optional.</td>
    </tr>
    <tr>
      <td>audit_request_body</td>
      <td>The HTTP body, if any and if request body logging is enabled. Optional.</td>
    </tr>
  </tbody>
</table>

<h2 id="transport-failed_login-attributes">Transport FAILED_LOGIN attributes</h2>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>audit_trace_task_id</td>
      <td>The ID of this request</td>
    </tr>
    <tr>
      <td>audit_transport_headers</td>
      <td>The headers of the request, if any. Optional.</td>
    </tr>
    <tr>
      <td>audit_request_effective_user</td>
      <td>The username / principal that failed authentication.</td>
    </tr>
    <tr>
      <td>audit_request_initiating_user</td>
      <td>The user that initiated the request. Only logged if it differs from the effective user, for example when using impersonation. Optional.</td>
    </tr>
    <tr>
      <td>audit_transport_request_type</td>
      <td>The type of request, e.g. <code class="highlighter-rouge">IndexRequest</code>, <code class="highlighter-rouge">SearchRequest</code></td>
    </tr>
    <tr>
      <td>audit_request_body</td>
      <td>The body / source, if any and if request body logging is enabled. Optional.</td>
    </tr>
    <tr>
      <td>audit_trace_indices</td>
      <td>The index name(s) as contained in the request. Can contain wildcards, date patterns and aliases. Only logged if <code class="highlighter-rouge">resolve_indices</code> is true. Optional.</td>
    </tr>
    <tr>
      <td>audit_trace_resolved_indices</td>
      <td>The resolved, concrete index name(s) affected by this request. Only logged if <code class="highlighter-rouge">resolve_indices</code> is true. Optional.</td>
    </tr>
    <tr>
      <td>audit_trace_doc_types</td>
      <td>The document types affecated by this request. Only logged if <code class="highlighter-rouge">resolve_indices</code> is true. Optional.</td>
    </tr>
  </tbody>
</table>

<h2 id="transport-authenticated-attributes">Transport AUTHENTICATED attributes</h2>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>audit_trace_task_id</td>
      <td>The ID of this request</td>
    </tr>
    <tr>
      <td>audit_transport_headers</td>
      <td>The headers of the request, if any. Optional.</td>
    </tr>
    <tr>
      <td>audit_request_effective_user</td>
      <td>The username / principal that failed authentication.</td>
    </tr>
    <tr>
      <td>audit_request_initiating_user</td>
      <td>The user that initiated the request. Only logged if it differs from the effective user, for example when using impersonation. Optional.</td>
    </tr>
    <tr>
      <td>audit_transport_request_type</td>
      <td>The type of request, e.g. <code class="highlighter-rouge">IndexRequest</code>, <code class="highlighter-rouge">SearchRequest</code></td>
    </tr>
    <tr>
      <td>audit_request_body</td>
      <td>The body / source, if any and if request body logging is enabled. Optional.</td>
    </tr>
    <tr>
      <td>audit_trace_indices</td>
      <td>The index name(s) as contained in the request. Can contain wildcards, date patterns and aliases. Only logged if <code class="highlighter-rouge">resolve_indices</code> is true. Optional.</td>
    </tr>
    <tr>
      <td>audit_trace_resolved_indices</td>
      <td>The resolved, concrete index name(s) affected by this request. Only logged if <code class="highlighter-rouge">resolve_indices</code> is true. Optional.</td>
    </tr>
    <tr>
      <td>audit_trace_doc_types</td>
      <td>The document types affecated by this request. Only logged if <code class="highlighter-rouge">resolve_indices</code> is true. Optional.</td>
    </tr>
  </tbody>
</table>

<h2 id="transport-missing_privileges-attributes">Transport MISSING_PRIVILEGES attributes</h2>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>audit_trace_task_id</td>
      <td>The ID of this request</td>
    </tr>
    <tr>
      <td>audit_trace_task_parent_id</td>
      <td>The parent ID of this request, if any. Optional.</td>
    </tr>
    <tr>
      <td>audit_transport_headers</td>
      <td>The headers of the request, if any. Optional.</td>
    </tr>
    <tr>
      <td>audit_request_effective_user</td>
      <td>The username / principal that failed authentication.</td>
    </tr>
    <tr>
      <td>audit_request_initiating_user</td>
      <td>The user that initiated the request. Only logged if it differs from the effective user, for example when using impersonation. Optional.</td>
    </tr>
    <tr>
      <td>audit_transport_request_type</td>
      <td>The type of request, e.g. <code class="highlighter-rouge">IndexRequest</code>, <code class="highlighter-rouge">SearchRequest</code></td>
    </tr>
    <tr>
      <td>audit_request_privilege</td>
      <td>The required privilege of the request, e.g. <code class="highlighter-rouge">indices:data/read/search</code></td>
    </tr>
    <tr>
      <td>audit_request_body</td>
      <td>The body / source, if any and if request body logging is enabled. Optional.</td>
    </tr>
    <tr>
      <td>audit_trace_indices</td>
      <td>The index name(s) as contained in the request. Can contain wildcards, date patterns and aliases. Only logged if <code class="highlighter-rouge">resolve_indices</code> is true. Optional.</td>
    </tr>
    <tr>
      <td>audit_trace_resolved_indices</td>
      <td>The resolved, concrete index name(s) affected by this request. Only logged if <code class="highlighter-rouge">resolve_indices</code> is true. Optional.</td>
    </tr>
    <tr>
      <td>audit_trace_doc_types</td>
      <td>The document types affecated by this request. Only logged if <code class="highlighter-rouge">resolve_indices</code> is true. Optional.</td>
    </tr>
  </tbody>
</table>

<h2 id="transport-granted_privileges-attributes">Transport GRANTED_PRIVILEGES attributes</h2>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>audit_trace_task_id</td>
      <td>The ID of this request</td>
    </tr>
    <tr>
      <td>audit_trace_task_parent_id</td>
      <td>The parent ID of this request, if any. Optional.</td>
    </tr>
    <tr>
      <td>audit_transport_headers</td>
      <td>The headers of the request, if any. Optional.</td>
    </tr>
    <tr>
      <td>audit_request_effective_user</td>
      <td>The username / principal that failed authentication.</td>
    </tr>
    <tr>
      <td>audit_request_initiating_user</td>
      <td>The user that initiated the request. Only logged if it differs from the effective user, for example when using impersonation. Optional.</td>
    </tr>
    <tr>
      <td>audit_transport_request_type</td>
      <td>The type of request, e.g. <code class="highlighter-rouge">IndexRequest</code>, <code class="highlighter-rouge">SearchRequest</code></td>
    </tr>
    <tr>
      <td>audit_request_privilege</td>
      <td>The required privilege of the request, e.g. <code class="highlighter-rouge">indices:data/read/search</code></td>
    </tr>
    <tr>
      <td>audit_request_body</td>
      <td>The body / source, if any and if request body logging is enabled. Optional.</td>
    </tr>
    <tr>
      <td>audit_trace_indices</td>
      <td>The index name(s) as contained in the request. Can contain wildcards, date patterns and aliases. Only logged if <code class="highlighter-rouge">resolve_indices</code> is true. Optional.</td>
    </tr>
    <tr>
      <td>audit_trace_resolved_indices</td>
      <td>The resolved, concrete index name(s) affected by this request. Only logged if <code class="highlighter-rouge">resolve_indices</code> is true. Optional.</td>
    </tr>
    <tr>
      <td>audit_trace_doc_types</td>
      <td>The document types affecated by this request. Only logged if <code class="highlighter-rouge">resolve_indices</code> is true. Optional.</td>
    </tr>
  </tbody>
</table>

<h2 id="transport-ssl_exception-attributes">Transport SSL_EXCEPTION attributes</h2>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>audit_request_exception_stacktrace</td>
      <td>The stacktrace of the SSL Exception</td>
    </tr>
  </tbody>
</table>

<h2 id="transport-bad_headers-attributes">Transport BAD_HEADERS attributes</h2>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>audit_trace_task_id</td>
      <td>The ID of this request</td>
    </tr>
    <tr>
      <td>audit_trace_task_parent_id</td>
      <td>The parent ID of this request, if any. Optional.</td>
    </tr>
    <tr>
      <td>audit_transport_headers</td>
      <td>The headers of the request, if any. Optional.</td>
    </tr>
    <tr>
      <td>audit_request_effective_user</td>
      <td>The username / principal that failed authentication.</td>
    </tr>
    <tr>
      <td>audit_request_initiating_user</td>
      <td>The user that initiated the request. Only logged if it differs from the effective user, for example when using impersonation. Optional.</td>
    </tr>
    <tr>
      <td>audit_transport_request_type</td>
      <td>The type of request, e.g. <code class="highlighter-rouge">IndexRequest</code>, <code class="highlighter-rouge">SearchRequest</code></td>
    </tr>
    <tr>
      <td>audit_request_body</td>
      <td>The body / source, if any and if request body logging is enabled. Optional.</td>
    </tr>
    <tr>
      <td>audit_trace_indices</td>
      <td>The index name(s) as contained in the request. Can contain wildcards, date patterns and aliases. Only logged if <code class="highlighter-rouge">resolve_indices</code> is true. Optional.</td>
    </tr>
    <tr>
      <td>audit_trace_resolved_indices</td>
      <td>The resolved, concrete index name(s) affected by this request. Only logged if <code class="highlighter-rouge">resolve_indices</code> is true. Optional.</td>
    </tr>
    <tr>
      <td>audit_trace_doc_types</td>
      <td>The document types affecated by this request. Only logged if <code class="highlighter-rouge">resolve_indices</code> is true. Optional.</td>
    </tr>
  </tbody>
</table>

<h2 id="transport-sg_index_attempt-attributes">Transport SG_INDEX_ATTEMPT attributes</h2>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>audit_trace_task_id</td>
      <td>The ID of this request</td>
    </tr>
    <tr>
      <td>audit_transport_headers</td>
      <td>The headers of the request, if any. Optional.</td>
    </tr>
    <tr>
      <td>audit_request_effective_user</td>
      <td>The username / principal that failed authentication.</td>
    </tr>
    <tr>
      <td>audit_request_initiating_user</td>
      <td>The user that initiated the request. Only logged if it differs from the effective user, for example when using impersonation. Optional.</td>
    </tr>
    <tr>
      <td>audit_transport_request_type</td>
      <td>The type of request, e.g. <code class="highlighter-rouge">IndexRequest</code>, <code class="highlighter-rouge">SearchRequest</code></td>
    </tr>
    <tr>
      <td>audit_request_body</td>
      <td>The body / source, if any and if request body logging is enabled. Optional.</td>
    </tr>
    <tr>
      <td>audit_trace_indices</td>
      <td>The index name(s) as contained in the request. Can contain wildcards, date patterns and aliases. Only logged if <code class="highlighter-rouge">resolve_indices</code> is true. Optional.</td>
    </tr>
    <tr>
      <td>audit_trace_resolved_indices</td>
      <td>The resolved, concrete index name(s) affected by this request. Only logged if <code class="highlighter-rouge">resolve_indices</code> is true. Optional.</td>
    </tr>
    <tr>
      <td>audit_trace_doc_types</td>
      <td>The document types affecated by this request. Only logged if <code class="highlighter-rouge">resolve_indices</code> is true. Optional.</td>
    </tr>
  </tbody>
</table>
